datasource db {
<<<<<<< HEAD:prisma/schema.prisma
  provider = "postgresql"  
  url      = env("DATABASE_URL")
=======
  provider = "postgresql"
>>>>>>> 1397e7043d2e7fdd07a386b3073957247653a069:server/prisma/schema.prisma
}

generator client {
  provider = "prisma-client-js"
}

model Administrador {
  id         String   @id @default(cuid())
  nombre     String
  email      String   @unique
  password   String
  telefono   String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

model Vendedor {
  id         String   @id @default(cuid())
  nombre     String
  edad       Int
  email      String   @unique
  telefono   String
  direccion  String
  password   String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  orders     Order[]
}

model Repartidor {
  id         String   @id @default(cuid())
  nombre     String
  edad       Int
  telefono   String
  direccion  String
  email      String   @unique
  password   String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  orders     Order[]
}

model Cliente {
  id         String   @id @default(cuid())
  nombre     String
  direccion  String
  email      String   @unique
  telefono   String
  password   String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  orders     Order[]
}

model Product {
  id          String      @id @default(cuid())
  name        String
  description String?
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
  OrderItem   OrderItem[]
  prices      Price[]
  inventory   Inventory?
}

model Price {
  id        String  @id @default(cuid())
  productId String
  product   Product @relation(fields: [productId], references: [id])
  price     Float
  isDelivery Boolean @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([productId, isDelivery])
}

model Inventory {
  id        String   @id @default(cuid())
  productId String   @unique
  product   Product  @relation(fields: [productId], references: [id])
  quantity  Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Order {
  id           String      @id @default(cuid())
  clienteId    String
  cliente      Cliente     @relation(fields: [clienteId], references: [id])
  repartidorId String?
  repartidor   Repartidor? @relation(fields: [repartidorId], references: [id])
  vendedorId   String?
  vendedor     Vendedor?   @relation(fields: [vendedorId], references: [id])
  status       OrderStatus @default(PENDIENTE)
  total        Float
  isDelivery   Boolean     @default(false)
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt
  items        OrderItem[]
  delivery     Delivery?
}

model OrderItem {
  id        String  @id @default(cuid())
  orderId   String
  order     Order   @relation(fields: [orderId], references: [id])
  productId String
  product   Product @relation(fields: [productId], references: [id])
  quantity  Int
  price     Float
}

model Delivery {
  id          String    @id @default(cuid())
  orderId     String    @unique
  order       Order     @relation(fields: [orderId], references: [id])
  address     String
  lat         Float?
  lng         Float?
  signature   String?
  deliveredAt DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

enum OrderStatus {
  PENDIENTE
  ASIGNADO
  EN_CAMINO
  ENTREGADO
  CANCELADO
}